<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-06-22">

<title>Prototype &amp; Storyboard – </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><img src="../images/OceanusFolkIcon.png" alt="Home" style="height: 68px; width: 68px;"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Project/Proposal.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Project/PrototypeStoryboard.html" aria-current="page"> 
<span class="menu-text">Storyboard</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-prototype" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Prototype</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-prototype">    
        <li>
    <a class="dropdown-item" href="../Project/Project.html">
 <span class="dropdown-text">Data Pre-processing &amp; Methodology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Project/Analysis.html">
 <span class="dropdown-text">Findings &amp; Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-shiny-app" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Shiny App</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-shiny-app">    
        <li>
    <a class="dropdown-item" href="../Project/XXX.html">
 <span class="dropdown-text">Shiny App</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Project/XXX.html">
 <span class="dropdown-text">User Guide</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../Project/XXX.html"> 
<span class="menu-text">Poster</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Project/XXX.html"> 
<span class="menu-text">Our Team</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link active" data-scroll-target="#r-packages">1 R Packages</a></li>
  <li><a href="#storyboard" id="toc-storyboard" class="nav-link" data-scroll-target="#storyboard">2 Storyboard</a>
  <ul class="collapse">
  <li><a href="#prototype-design-concept-and-user-interface" id="toc-prototype-design-concept-and-user-interface" class="nav-link" data-scroll-target="#prototype-design-concept-and-user-interface">2.1 Prototype, Design Concept and User Interface</a></li>
  <li><a href="#profile-of-sailors-career" id="toc-profile-of-sailors-career" class="nav-link" data-scroll-target="#profile-of-sailors-career">2.1.1 Profile of Sailor’s Career</a></li>
  <li><a href="#influence-of-oceanus-folk" id="toc-influence-of-oceanus-folk" class="nav-link" data-scroll-target="#influence-of-oceanus-folk">2.1.2 Influence of Oceanus Folk</a></li>
  <li><a href="#oceanus-folks-rising-stars" id="toc-oceanus-folks-rising-stars" class="nav-link" data-scroll-target="#oceanus-folks-rising-stars">2.1.3 Oceanus Folk’s Rising Stars</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Prototype &amp; Storyboard</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 22, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 23, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="r-packages" class="level1">
<h1>1 R Packages</h1>
<p>There are the R Packages which we will be using in our Shiny App.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Data Manipulation and Project Reporting</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Data Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Interactive and Web</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Network and Graph Analysis</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><strong><code>tidyverse</code></strong>: R packages for data science workflows.</li>
<li><strong><code>dplyr</code></strong>: Data manipulation using grammar of data (e.g., <code>filter()</code>, <code>summarise()</code>).</li>
<li><strong><code>stringr</code></strong>: String operations with simplified syntax.</li>
<li><strong><code>lubridate</code></strong>: Easy handling of dates and times.</li>
<li><strong><code>jsonlite</code></strong>: Read and write JSON data.</li>
<li><strong><code>knitr</code></strong>: Generates documents that uses both R code and markdown.</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li><strong><code>ggplot2</code></strong>: Grammar of Graphics framework for plotting.</li>
<li><strong><code>ggtext</code></strong>: Adds markdown/HTML text support to ggplot.</li>
<li><strong><code>patchwork</code></strong>: Combine multiple ggplots in grid layouts.</li>
<li><strong><code>ggnewscale</code></strong>: Enables multiple <code>fill</code> or <code>colour</code> scales in the same plot.</li>
<li><strong><code>scales</code></strong>: Control axis breaks, labels (e.g.&nbsp;percentages, currency).</li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ul>
<li><strong><code>shiny</code></strong>: Build interactive web applications in R.</li>
<li><strong><code>ggiraph</code></strong>: Adds interactivity (e.g.&nbsp;hover, tooltips) to ggplot visualisations.</li>
</ul>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<ul>
<li><strong><code>igraph</code></strong>: Graph package for network.</li>
<li><strong><code>tidygraph</code></strong>: Tidy interface for working with graphs based on <code>dplyr</code>.</li>
<li><strong><code>ggraph</code></strong>: ggplot2-based framework for visualising graphs and networks.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="storyboard" class="level1">
<h1>2 Storyboard</h1>
<p>Our Shiny App is structured and designed to guide users through a different aspect of the Oceanus Folk music genre and Sailor Shift’s career.</p>
<p>It begins with a tab on the “Profile of Sailor’s Career”, which presents a detailed timeline of Sailor Shift’s rise, showcasing her key career milestones, albums, collaborations etc. This tab includes several network visualisations that enables users to explore Sailor’s connections and influence,</p>
<p>The second tab, “Influence of Oceanus Folk”, dives into the broader impact of the genre using temporal analyses like bar and line graphs, visualising metrics such as yearly influence spread, Bayesian Surprise and genre entropy over time.</p>
<p>The third tab, “Oceanus Folk’s Rising Stars”, showcases existing and emerging artists using visual tools such as radar charts, career trajectory plots and data tables ranking artists by their “Star Factor” scores. A linear regression forecast until 2045 is also included to predict the rising stars.</p>
<section id="prototype-design-concept-and-user-interface" class="level2">
<h2 class="anchored" data-anchor-id="prototype-design-concept-and-user-interface">2.1 Prototype, Design Concept and User Interface</h2>
</section>
<section id="profile-of-sailors-career" class="level2">
<h2 class="anchored" data-anchor-id="profile-of-sailors-career">2.1.1 Profile of Sailor’s Career</h2>
<p>The prototypes are illustrated below:</p>
<p><img src="..\Images/Storyboard/Slide1.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>At the top bar, users can navigate across multiple pages to explore Sailor Shift’s career journey and the evolution of the Oceanus Folk genre from various angles.</p></li>
<li><p>A user guide is accessible at the top right corner of the dashboard to help users understand the interface and navigate the pages with ease.</p></li>
<li><p>Using sidebarLayout(), we create a side panel for feature selection and main panel for plots and explanation. The side panel will include interactive controls such as radio buttons to toggle between node and edge types.</p></li>
<li><p>Each tab allows users to take a deeper dive into specific aspects of Sailor Shift’s career, offering multiple perspectives through interactive visuals.</p></li>
<li><p>All network visualization should allow interactions such as hover with tooltips to allow users to explore secondary details further.</p>
<ul>
<li><p>As the network diagram consist of different nodes and edges which would be coloured differently in a network diagram, we used colours to determine the visual hierarchy: Group non-Oceanus Folk genre together as “Other Genre” to have a single node colour</p></li>
<li><p>Group all edges belonging to “InStyleOf”, “InterpolatesFrom”, “CoverOf”, “LyricalReferenceTo”, “DirectlySamples”) as “Influenced By“ to have a single edge colour</p></li>
<li><p>“PerformerOf”, “ComposerOf”, “ProducerOf”, “LyricistOf”, “RecordedBy”, “DistributedBy“ as “Creator Of” to have a single edge colour</p></li>
</ul></li>
<li><p>A data table will be included for users to explore further details where required.</p></li>
</ol>
<p><img src="..\Images/Storyboard/Slide2.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>Network visualisation allows users to clearly see Sailor Shift’s activities, her interactions with other artists, and the channels through which she exerted influence.</p></li>
<li><p>Key insights are provided below the network visualisation to enhance user understanding after the user has explored the network.</p></li>
<li><p>The same design and network visualization will apply for the 3<sup>rd</sup> and 4<sup>th</sup> tab.</p></li>
</ol>
</section>
<section id="influence-of-oceanus-folk" class="level2">
<h2 class="anchored" data-anchor-id="influence-of-oceanus-folk">2.1.2 Influence of Oceanus Folk</h2>
<p><img src="..\Images/Storyboard/Slide3.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<p>The tabs are organised to follow natural user reading patterns (left to right, top to bottom) for optimal readability. Visualisations are arranged in a logical sequence that aligns with the user’s thought process: starting with data exploration visuals, followed by analysis-driven visualisations.</p>
<ol type="1">
<li><p>Feature selection is included such as for year. E.g. if the users want to analyse trends between specific periods.</p></li>
<li><p>Guided interpretations of the graph are provided, along with an explanation of Bayesian Surprise to help assess whether Oceanus Folk’s influence was intermittent or developed gradually.</p></li>
<li><p>A bar and line graph shows both the yearly count and cumulative count of Oceanus Folk releases and its influence works, helping users visualise the genre’s growth over time.</p></li>
<li><p>The line graph plots Bayesian Surprise over time, pinpointing years where shifts in the genre’s development were most unexpected, thus offering deeper insight into the dynamics of its evolution.</p></li>
</ol>
<p><img src="..\Images/Storyboard/Slide4.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>An explanation of the Sankey diagram is provided to help users understand its purpose and how to interpret the visual flow.</p></li>
<li><p>Separate but consistently designed tabs use Sankey diagrams (Oceanus Folk → genres/artists) to show which genres and top artists have been most influenced by Oceanus Folk.</p></li>
<li><p>A supporting data table is included for users who want to explore detailed information beyond the respective visual summary.</p></li>
<li><p>The same design concept will apply for “Outward Influence on other Artists” and “Inward Influence from other Genres”.</p></li>
</ol>
<p><img src="..\Images/Storyboard/Slide5.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>An explanation of Genre Entropy to explain how Oceanus Folk has been influenced by and has influenced other genres over time, particularly with the rise of Sailor Shift.</p></li>
<li><p>Genre Entropy is visualised through a bar graph, showing the yearly counts of incoming and outgoing influences to highlight how Oceanus Folk evolves and impacts other genres.</p></li>
</ol>
</section>
<section id="oceanus-folks-rising-stars" class="level2">
<h2 class="anchored" data-anchor-id="oceanus-folks-rising-stars">2.1.3 Oceanus Folk’s Rising Stars</h2>
<p><img src="..\Images/Storyboard/Slide6.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>A filter panel allows users to select specific genres and artists to customise the radar charts display. User can select a preferred artist to examine its works/ influence over time.</p></li>
<li><p>An explanation is provided on how the ‘Star Factor’ metric was derived</p></li>
<li><p>A data table will show the ranked artists based on star factor.</p></li>
<li><p>The radar charts displays how the selected artist perform across the selected factors, offering a clear visual comparison of their strengths and profiles.</p></li>
<li><p>The bar and line graphs as well as network diagram of the artist’s work and influence over time is shown.</p></li>
</ol>
<p><img src="..\Images/Storyboard/Slide7.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>The tab shows the combined radar chart, bar and line graphs of the work/influence of 3 artists.</p></li>
<li><p>As a default, the top 3 artists with highest star factor will be selected in the artist field.</p></li>
<li><p>The bar and line graphs of the works of the 3 artists will be plotted in the same chart.</p></li>
</ol>
<p><img src="..\Images/Storyboard/Slide8.PNG" class="img-fluid"></p>
<p><u>Design Concept and User Interface for the page above</u></p>
<ol type="1">
<li><p>The bar and line graph will show trending of the star factor between 2030 to 2045. The bar and line graphs of the works of the top 10 artists will be plotted in the same chart.</p></li>
<li><p>The data table will consist of the linear regression results until 2045.</p></li>
<li><p>The Radar Chart of the top 3 artists will be reflected.</p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>